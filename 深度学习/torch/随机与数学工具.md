# 随机种子

随机种子：​`torch.manual_seed(seed)`​设置全局随机数生成器，影响所有后续的随机操作（除非中途修改了种子）

若使用了numpy或random，也要同步设置

```python
import random
import numpy as np

random.seed(42)
np.random.seed(42)
torch.manual_seed(42)
# 这样整个项目的随机行为都能得到复现
```

# `torch.distributions`​

提供各种概率分布的实现

## Multinomial 分布

多项分布是离散分布的一种，用于描述在每个实验中有 ( n ) 次独立试验，每次试验有 ( k ) 个可能的结果的情况。这个分布的输出是一个向量，其中每个元素表示每个可能结果出现的次数

```python
from torch.distributions import Multinomial

probs = torch.tensor([0.2, 0.5, 0.3])	# 定义概率

n = 10  # 每次试验的总次数

multinomial_dist = Multinomial(total_count=n, probs=probs)	# 创建多项分布对象
```

主要参数:

- total\_count: 一个整数，表示每次试验的总次数 n
- probs: 一个形状为 ( (k,) ) 的张量，表示每种结果的概率，这些概率应该是非负的，并且它们的总和应该等于 1
- logits: 可选，使用 logits 而不是概率来表示结果的偏好

方法：

- `.sample()`: 从多项分布中生成样本
- `.log_prob(sample)`: 计算给定样本的对数概率



# 伯努利分布

两种实现方式

```python
# 函数式
a = torch.rand(3, 3)	# 概率
x = torch.bernoulli(a)	# 以给定概率生成样本，x元素为0或1

# Bernoulli类
from torch.distributions import Bernoulli
bernoulli = Bernoulli(probs=0.7)
samples = bernoulli.sample((5,))	# 生成5个样本
```

类的关键方法：

| 方法          | 功能         | 示例                            |
| ------------- | ------------ | ------------------------------- |
| `.sample()`   | 生成样本     | `bernoulli.sample((2,))`        |
| `.log_prob()` | 计算对数概率 | `bernoulli.log_prob(tensor(1))` |
| `.entropy()`  | 计算分布的熵 | `bernoulli.entropy()`           |

Dropout 本质是伯努利采样，随机置零神经元

