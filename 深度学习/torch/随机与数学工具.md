## Random与概率分布

伯努利分布采样函数：

```python
a = torch.randd(3, 3)
torch.bernoulli(a)
```

对张量 `a`​ 中的每个元素 `p`​，以概率 `p`​ 输出 `1`​，以概率 `1-p`​ 输出 `0`​，相当于每个元素都是一次“带权概率的硬币抛掷”

随机种子：​`torch.manual_seed(seed)`​设置全局随机数生成器，影响所有后续的随机操作（除非中途修改了种子）

若使用了numpy或random，也要同步设置

```python
import random
import numpy as np

random.seed(42)
np.random.seed(42)
torch.manual_seed(42)
# 这样整个项目的随机行为都能得到复现
```

`torch.distributions`​

提供各种概率分布的实现

Multinomial 分布: 多项分布是离散分布的一种，用于描述在每个实验中有 ( n ) 次独立试验，每次试验有 ( k ) 个可能的结果的情况。这个分布的输出是一个向量，其中每个元素表示每个可能结果出现的次数

```python
from torch.distributions import Multinomial

probs = torch.tensor([0.2, 0.5, 0.3])	# 定义概率

n = 10  # 每次试验的总次数

multinomial_dist = Multinomial(total_count=n, probs=probs)	# 创建多项分布对象
```

主要参数:

- total\_count: 一个整数，表示每次试验的总次数 n
- probs: 一个形状为 ( (k,) ) 的张量，表示每种结果的概率，这些概率应该是非负的，并且它们的总和应该等于 1
- logits: 可选，使用 logits 而不是概率来表示结果的偏好

方法：

- `.sample()`: 从多项分布中生成样本
- `.log_prob(sample)`: 计算给定样本的对数概率